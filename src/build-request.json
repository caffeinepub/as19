{
  "kind": "build_request",
  "title": "Add Master Admin Dashboard with Analytics and Privacy Guardrails",
  "projectName": "AS19 MultiDrive",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Create a backend method to track and return the total number of unique user principals (User Tokens) who have created profiles in the system",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "User Counter: A real-time tracker for the total number of unique User Tokens/Principals"
        ]
      },
      "acceptanceCriteria": [
        "Backend provides a query method that returns the count of unique principals",
        "Count updates in real-time as new users register",
        "Method is accessible only to admin principals"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Create a backend method to track and return the total number of virtual canisters generated by the system",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Canister Inventory: Track the total number of 'Virtual Canisters' automatically generated by the cross-lock logic"
        ]
      },
      "acceptanceCriteria": [
        "Backend tracks virtual canister count",
        "Count is accessible via admin-only query method",
        "Virtual canister creation increments the counter automatically"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Create backend methods to return storage metadata per user token including total bytes used for photos, videos, documents, and memories, without exposing actual file content",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Storage Insights: Show individual storage usage per token and the 'Total Aggregated Data' stored across the entire network (in TB/GB)",
          "The Admin Panel must NOT have access to view, read, or download the actual content (files/notes/photos) stored in user canisters. It should only fetch 'Metadata' (size, timestamp, token ID)"
        ]
      },
      "acceptanceCriteria": [
        "Backend returns metadata including file sizes, timestamps, and token IDs",
        "No file content or download URLs are exposed to admin methods",
        "Storage totals are calculated and returned in bytes",
        "Method aggregates data across all users to show total network storage"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Create a backend method to monitor and return the cycle balance of the main canister",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Network Health: Monitor the 'Cycle Balance' of all canisters to ensure the system remains self-sustaining"
        ]
      },
      "acceptanceCriteria": [
        "Backend exposes canister cycle balance via admin-only query",
        "Cycle balance is returned in a human-readable format",
        "Method checks sustainability thresholds"
      ]
    },
    {
      "id": "REQ-5",
      "text": "Implement principal-based access control in the backend to restrict all admin analytics methods to only the founder's Master Principal ID",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Lock this dashboard behind Internet Identity authentication, restricted specifically to my Master Principal ID",
          "This will be a separate protected canister only accessible by my Principal ID"
        ]
      },
      "acceptanceCriteria": [
        "All admin methods verify the caller's principal matches the configured Master Principal ID",
        "Unauthorized principals receive an error when attempting to access admin methods",
        "Master Principal ID is configurable in the backend code"
      ]
    },
    {
      "id": "REQ-6",
      "text": "Create an Admin Dashboard page component accessible only to authenticated users with the Master Principal ID, displaying user count, canister inventory, storage insights, and cycle balance",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "I need to build a high-level 'Master Admin Dashboard' for my AS19 MultiDrive",
          "Lock this dashboard behind Internet Identity authentication, restricted specifically to my Master Principal ID"
        ]
      },
      "acceptanceCriteria": [
        "Dashboard page is protected by Internet Identity authentication",
        "Page verifies user principal matches Master Principal ID before rendering",
        "Unauthorized users see an access denied message",
        "Dashboard displays real-time analytics from backend"
      ]
    },
    {
      "id": "REQ-7",
      "text": "Design the Admin Dashboard with a dark-themed Command Center interface featuring visual counters for user count and canister inventory, progress bars showing storage distribution across categories, and cycle balance indicators",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Build a clean, dark-themed 'Command Center' interface with visual counters and progress bars showing storage distribution"
        ]
      },
      "acceptanceCriteria": [
        "Dashboard uses a dark theme with high contrast",
        "User and canister counts are displayed in prominent counter components",
        "Storage usage shows progress bars for total storage and per-category breakdown",
        "Cycle balance is displayed with visual indicators for health status",
        "Layout resembles a command center with organized metric cards"
      ]
    },
    {
      "id": "REQ-8",
      "text": "Create React Query hooks to fetch admin analytics data including user count, canister count, storage insights, and cycle balance from the backend",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Analytics & Metadata Tracking: User Counter, Canister Inventory, Storage Insights, Network Health"
        ]
      },
      "acceptanceCriteria": [
        "Hooks use React Query for data fetching and caching",
        "Data refreshes at regular intervals to show real-time updates",
        "Error states are handled gracefully",
        "Loading states are displayed during data fetch"
      ]
    },
    {
      "id": "REQ-9",
      "text": "Display individual storage usage per user token in a table or list view on the Admin Dashboard, showing token ID, total storage used, and breakdown by category (photos, videos, documents, memories) in GB/TB format",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Storage Insights: Show individual storage usage per token and the 'Total Aggregated Data' stored across the entire network (in TB/GB)"
        ]
      },
      "acceptanceCriteria": [
        "Table displays all user tokens with their storage metrics",
        "Storage sizes are formatted in appropriate units (MB, GB, TB)",
        "Category breakdown is visible for each token",
        "Total aggregated storage is prominently displayed at the top"
      ]
    },
    {
      "id": "REQ-10",
      "text": "Add navigation to the Admin Dashboard from the main application navigation bar, visible only to users with the Master Principal ID",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-20"
        ],
        "quotes": [
          "Master Admin Dashboard",
          "Lock this dashboard behind Internet Identity authentication, restricted specifically to my Master Principal ID"
        ]
      },
      "acceptanceCriteria": [
        "Admin Dashboard link appears in the navigation bar only for the founder principal",
        "Link navigates to the admin dashboard route",
        "Regular users do not see the admin navigation option"
      ]
    }
  ],
  "constraints": [
    "Backend must use Motoko only (no Rust support available)",
    "Admin methods must never expose actual file content, only metadata (size, timestamp, token ID)",
    "All admin analytics methods must verify caller principal matches Master Principal ID",
    "Frontend must use existing authentication via Internet Identity",
    "Do not modify immutable frontend paths: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, frontend/src/components/ui"
  ],
  "nonGoals": [
    "Direct Google OAuth authentication (platform only supports Internet Identity)",
    "Viewing, downloading, or accessing actual user file content from admin dashboard",
    "Modifying user data from the admin dashboard",
    "Creating a separate canister (system uses single-actor architecture)",
    "Multi-canister deployment or cross-canister calls",
    "Email authentication or external auth providers"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}